_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[16],{"1OyB":function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",(function(){return r}))},"8oxB":function(e,t){var n,r,a=e.exports={};function c(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function i(e){if(n===setTimeout)return setTimeout(e,0);if((n===c||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"===typeof setTimeout?setTimeout:c}catch(e){n=c}try{r="function"===typeof clearTimeout?clearTimeout:o}catch(e){r=o}}();var s,u=[],l=!1,f=-1;function b(){l&&s&&(l=!1,s.length?u=s.concat(u):f=-1,u.length&&p())}function p(){if(!l){var e=i(b);l=!0;for(var t=u.length;t;){for(s=u,u=[];++f<t;)s&&s[f].run();f=-1,t=u.length}s=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function d(){}a.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new h(e,t)),1!==u.length||l||i(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=d,a.addListener=d,a.once=d,a.off=d,a.removeListener=d,a.removeAllListeners=d,a.emit=d,a.prependListener=d,a.prependOnceListener=d,a.listeners=function(e){return[]},a.binding=function(e){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},"C/mO":function(e,t,n){"use strict";n.r(t);var r,a,c,o,i,s,u=n("KQm4"),l=n("o0o1"),f=n.n(l),b=n("HaE+"),p=n("ODXe"),h=n("nKUr"),d=n("YFqc"),j=n.n(d),O=n("q1tI"),w=n.n(O),v=n("1OyB"),m=n("rePB"),g=n("U2S/"),y=n("m9EI"),x=n("m1br"),k=n.n(x),T=new WeakMap,M=new WeakMap,E=new WeakMap,S=new WeakMap,C=new WeakMap,W=new WeakMap,P=new WeakMap,L=function e(t,n,r,a,c,o){var i=this;Object(v.a)(this,e),T.set(this,{writable:!0,value:""}),M.set(this,{writable:!0,value:""}),E.set(this,{writable:!0,value:""}),S.set(this,{writable:!0,value:void 0}),C.set(this,{writable:!0,value:function(){}}),W.set(this,{writable:!0,value:function(){}}),P.set(this,{writable:!0,value:function(){}}),Object(m.a)(this,"connect",Object(b.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=y.a,e.t1=i,e.t2=S,e.next=5,k.a.create({repo:"".concat(Object(g.a)(i,M),"-repo-").concat(Math.random().toString(36).substring(7)),config:{Addresses:{Swarm:[Object(g.a)(i,T)]}}});case 5:e.t3=e.sent,(0,e.t0)(e.t1,e.t2,e.t3),Object(g.a)(i,S).libp2p.on("peer:discovery",Object(g.a)(i,C)),Object(g.a)(i,S).libp2p.connectionManager.on("peer:connect",Object(g.a)(i,W)),Object(g.a)(i,S).libp2p.connectionManager.on("peer:disconnect",Object(g.a)(i,P));case 10:case"end":return e.stop()}}),e)})))),Object(m.a)(this,"ChannelBuilder",(function(){var e,t,n=Object(g.a)(i,M),r=(Object(g.a)(i,E),Object(g.a)(i,S));return new(e=new WeakMap,t=new WeakMap,function(){return function a(){var c=this;Object(v.a)(this,a),e.set(this,{writable:!0,value:function(){}}),t.set(this,{writable:!0,value:""}),Object(m.a)(this,"setOnReceiveMessage",(function(t){return Object(y.a)(c,e,t),c})),Object(m.a)(this,"setSuffix",(function(e){return Object(y.a)(c,t,"".concat(n,":").concat(e)),c})),Object(m.a)(this,"build",(function(){return{subscribe:function(){var n=Object(b.a)(f.a.mark((function n(){return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.pubsub.subscribe(Object(g.a)(c,t),Object(g.a)(c,e));case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),publish:function(){var e=Object(b.a)(f.a.mark((function e(n){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.pubsub.publish(Object(g.a)(c,t),n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),unsubscribe:function(){var e=Object(b.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.pubsub.unsubscribe(Object(g.a)(c,t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}}))}}())})),Object(y.a)(this,T,t),Object(y.a)(this,M,n),Object(y.a)(this,E,r),Object(y.a)(this,P,a),Object(y.a)(this,W,c),Object(y.a)(this,C,o)};Object(m.a)(L,"Builder",(r=new WeakMap,a=new WeakMap,c=new WeakMap,o=new WeakMap,i=new WeakMap,s=new WeakMap,function(){return function e(){var t=this;Object(v.a)(this,e),r.set(this,{writable:!0,value:""}),a.set(this,{writable:!0,value:""}),c.set(this,{writable:!0,value:""}),o.set(this,{writable:!0,value:function(){}}),i.set(this,{writable:!0,value:function(){}}),s.set(this,{writable:!0,value:function(){}}),Object(m.a)(this,"setSwarmMultiaddr",(function(e){return Object(y.a)(t,r,e),t})),Object(m.a)(this,"setPrefix",(function(e){return Object(y.a)(t,a,e),t})),Object(m.a)(this,"setSecretKey",(function(e){return Object(y.a)(t,c,e),t})),Object(m.a)(this,"setOnDiscoverPeer",(function(e){return Object(y.a)(t,o,e),t})),Object(m.a)(this,"setOnConnectPeer",(function(e){return Object(y.a)(t,i,e),t})),Object(m.a)(this,"setOnDisconnectPeer",(function(e){return Object(y.a)(t,s,e),t})),Object(m.a)(this,"build",(function(){return new L(Object(g.a)(t,r),Object(g.a)(t,a),Object(g.a)(t,c),Object(g.a)(t,o),Object(g.a)(t,i),Object(g.a)(t,s))}))}}()));t.default=function(){var e=w.a.useState(),t=Object(p.a)(e,2),n=t[0],r=t[1],a=w.a.useState("/dns4/wrtc-star2.sjc.dwebops.pub/tcp/443/wss/p2p-webrtc-star"),c=Object(p.a)(a,2),o=c[0],i=c[1],s=w.a.useState(""),l=Object(p.a)(s,2),d=l[0],O=l[1],v=w.a.useState(!1),m=Object(p.a)(v,2),g=m[0],y=m[1],x=w.a.useState(),k=Object(p.a)(x,2),T=k[0],M=k[1],E=w.a.useState(""),S=Object(p.a)(E,2),C=S[0],W=S[1],P=w.a.useState(""),_=Object(p.a)(P,2),R=_[0],B=_[1],D=w.a.useState(""),N=Object(p.a)(D,2),K=N[0],A=N[1],I=w.a.useState([]),J=Object(p.a)(I,2),U=J[0],F=J[1];return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(j.a,{href:"/",children:"\ud83d\udd19 Back"}),Object(h.jsx)("h1",{children:"Nebulark Discovery Examples"}),Object(h.jsx)("section",{id:"instructions",children:Object(h.jsxs)("em",{children:["Please ensure that you are in a ",Object(h.jsx)("strong",{children:"secure context"})," (i.e. a HTTPS secured page or localhost), otherwise the examples below might not work. Please also note that if you use the public WebRTC star below, the initial connection establishment might take a very long time (multiple minutes) or maybe not even work at all. For more information and solutions, please check out the"," ",Object(h.jsx)("a",{href:"https://github.com/pojntfx/nebulark#discovery",children:"README"}),"."]})}),Object(h.jsxs)("section",{id:"broadcast-room",children:[Object(h.jsx)("h2",{children:"Network Connection"}),Object(h.jsx)("input",{type:"text",placeholder:"Swarm multiaddr",value:o,onChange:function(e){return i(e.target.value)}}),Object(h.jsx)("br",{}),Object(h.jsx)("input",{type:"text",placeholder:"Secret key",value:d,onChange:function(e){return O(e.target.value)}}),Object(h.jsx)("button",{onClick:Object(b.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(new L.Builder).setSwarmMultiaddr(o).setPrefix("nebulark-discovery-examples").setSecretKey(d).setOnDiscoverPeer((function(e){return console.log("discovered peer",e)})).setOnConnectPeer((function(e){return console.log("connected to peer",e)})).setOnDisconnectPeer((function(e){return console.log("disconnected from peer",e)})).build(),e.next=3,t.connect();case 3:r(t),y(!0);case 5:case"end":return e.stop()}}),e)}))),children:"Connect"}),Object(h.jsx)("span",{children:g?"\u2705 Connected":"\u274c Disconnected"}),g&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("h2",{children:"Room Connection"}),Object(h.jsx)("input",{type:"text",placeholder:"Room name",value:C,onChange:function(e){return W(e.target.value)}}),Object(h.jsx)("button",{onClick:Object(b.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.ChannelBuilder().setOnReceiveMessage(function(){var e=Object(b.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("received message"),F((function(e){return[].concat(Object(u.a)(e),[(new TextDecoder).decode(t.data)])}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).setSuffix(C).build(),e.next=3,t.subscribe();case 3:M(t),B(!0);case 5:case"end":return e.stop()}}),e)}))),children:"Join room"}),Object(h.jsx)("span",{children:R?"\u2705 Joined":"\u274c Not yet joined"}),Object(h.jsx)("br",{}),R&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("input",{type:"text",placeholder:"Message content",value:K,onChange:function(e){return A(e.target.value)}}),Object(h.jsx)("button",{onClick:Object(b.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.group("sending message"),e.next=3,T.publish((new TextEncoder).encode(K));case 3:A("");case 4:case"end":return e.stop()}}),e)}))),children:"Send message"}),Object(h.jsx)("h3",{children:"Messages"}),Object(h.jsx)("ul",{children:U.map((function(e,t){return Object(h.jsx)("li",{children:e},t)}))})]})]})]})]})}},KQm4:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("a3WO");var a=n("BsWD");function c(e){return function(e){if(Array.isArray(e))return Object(r.a)(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Object(a.a)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},"U2S/":function(e,t,n){"use strict";function r(e,t){var n=t.get(e);if(!n)throw new TypeError("attempted to get private field on non-instance");return n.get?n.get.call(e):n.value}n.d(t,"a",(function(){return r}))},YFqc:function(e,t,n){e.exports=n("cTJO")},cTJO:function(e,t,n){"use strict";var r=n("J4zp"),a=n("284h");t.__esModule=!0,t.default=void 0;var c,o=a(n("q1tI")),i=n("elyg"),s=n("nOHt"),u=new Map,l=window.IntersectionObserver,f={};var b=function(e,t){var n=c||(l?c=new l((function(e){e.forEach((function(e){if(u.has(e.target)){var t=u.get(e.target);(e.isIntersecting||e.intersectionRatio>0)&&(c.unobserve(e.target),u.delete(e.target),t())}}))}),{rootMargin:"200px"}):void 0);return n?(n.observe(e),u.set(e,t),function(){try{n.unobserve(e)}catch(t){console.error(t)}u.delete(e)}):function(){}};function p(e,t,n,r){(0,i.isLocalURL)(t)&&(e.prefetch(t,n,r).catch((function(e){0})),f[t+"%"+n]=!0)}var h=function(e){var t=!1!==e.prefetch,n=o.default.useState(),a=r(n,2),c=a[0],u=a[1],h=(0,s.useRouter)(),d=h&&h.pathname||"/",j=o.default.useMemo((function(){var t=(0,i.resolveHref)(d,e.href,!0),n=r(t,2),a=n[0],c=n[1];return{href:a,as:e.as?(0,i.resolveHref)(d,e.as):c||a}}),[d,e.href,e.as]),O=j.href,w=j.as;o.default.useEffect((function(){if(t&&l&&c&&c.tagName&&(0,i.isLocalURL)(O)&&!f[O+"%"+w])return b(c,(function(){p(h,O,w)}))}),[t,c,O,w,h]);var v=e.children,m=e.replace,g=e.shallow,y=e.scroll;"string"===typeof v&&(v=o.default.createElement("a",null,v));var x=o.Children.only(v),k={ref:function(e){e&&u(e),x&&"object"===typeof x&&x.ref&&("function"===typeof x.ref?x.ref(e):"object"===typeof x.ref&&(x.ref.current=e))},onClick:function(e){x.props&&"function"===typeof x.props.onClick&&x.props.onClick(e),e.defaultPrevented||function(e,t,n,r,a,c,o){("A"!==e.currentTarget.nodeName||!function(e){var t=e.currentTarget.target;return t&&"_self"!==t||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey||e.nativeEvent&&2===e.nativeEvent.which}(e)&&(0,i.isLocalURL)(n))&&(e.preventDefault(),null==o&&(o=r.indexOf("#")<0),t[a?"replace":"push"](n,r,{shallow:c}).then((function(e){e&&o&&(window.scrollTo(0,0),document.body.focus())})))}(e,h,O,w,m,g,y)}};return t&&(k.onMouseEnter=function(e){(0,i.isLocalURL)(O)&&(x.props&&"function"===typeof x.props.onMouseEnter&&x.props.onMouseEnter(e),p(h,O,w,{priority:!0}))}),(e.passHref||"a"===x.type&&!("href"in x.props))&&(k.href=(0,i.addBasePath)((0,i.addLocale)(w,h&&h.locale,h&&h.defaultLocale))),o.default.cloneElement(x,k)};t.default=h},g3bu:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/examples/discovery",function(){return n("C/mO")}])},m9EI:function(e,t,n){"use strict";function r(e,t,n){var r=t.get(e);if(!r)throw new TypeError("attempted to set private field on non-instance");if(r.set)r.set.call(e,n);else{if(!r.writable)throw new TypeError("attempted to set read only private field");r.value=n}return n}n.d(t,"a",(function(){return r}))}},[["g3bu",0,1,7,2,3,4,6,9]]]);